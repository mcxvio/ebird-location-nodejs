var http = require('http');

http.createServer(function (req, res) {
    //console.log('hello world, start');
    
    //res.writeHead(200, {'Content-Type': 'text/plain'});
    //res.end('Hello World\n');
    
    var Converter = require("csvtojson").Converter;
    
    var converter = new Converter({});
    
    converter.on("end_parsed", function (jsonArray) {
        //console.log(jsonArray); // the result.
        res.end(JSON.stringify(jsonArray));
    });

    require("fs").createReadStream("./data/ebird_api_ref_location_eBird_list_country.csv").pipe(converter);

    //console.log('hello world, end');
}).listen(process.env.PORT, process.env.IP);
